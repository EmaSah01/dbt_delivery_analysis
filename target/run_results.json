{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2026-01-07T13:17:00.941526Z", "invocation_id": "a170d3cb-1b97-472c-9805-db5edfff3e07", "invocation_started_at": "2026-01-07T13:16:57.928218Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-07T13:17:00.287215Z", "completed_at": "2026-01-07T13:17:00.312495Z"}, {"name": "execute", "started_at": "2026-01-07T13:17:00.313851Z", "completed_at": "2026-01-07T13:17:00.605184Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3355388641357422, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_delivery_analytics.courier_load", "compiled": true, "compiled_code": "with shipments as (\n    select *\n    from \"delivery_analytics2\".\"analytics\".\"fct_shipments\"\n)\n\nselect\n    courier_id,\n    shipment_date,\n    count(*) as total_shipments_per_day,\n    count(case when current_status != 'delivered' then 1 end) as active_shipments\nfrom shipments\ngroup by courier_id, shipment_date\norder by courier_id, shipment_date\n\n/*\nVIEW: courier_load\n\nSvrha:\n- Analiza radnog optere\u0107enja kurira po danu\n- active_shipments = po\u0161iljke koje nisu jo\u0161 dostavljene\n*/", "relation_name": "\"delivery_analytics2\".\"analytics\".\"courier_load\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-07T13:17:00.296676Z", "completed_at": "2026-01-07T13:17:00.313169Z"}, {"name": "execute", "started_at": "2026-01-07T13:17:00.361799Z", "completed_at": "2026-01-07T13:17:00.617716Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3426249027252197, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_delivery_analytics.delays_by_city_type", "compiled": true, "compiled_code": "with delays as (\n    select *\n    from \"delivery_analytics2\".\"analytics\".\"fct_shipment_delays\"\n)\n\nselect\n    delivery_city,\n    delivery_type,\n    count(*) as total_shipments,\n    count(case when is_late_delivery = false then 1 end) as on_time_shipments,\n    avg(delay_days) as avg_delay_days\nfrom delays\ngroup by delivery_city, delivery_type\norder by delivery_city, delivery_type\n\n/*\nVIEW: delays_by_city_type\n\nSvrha:\n- Agregacija ka\u0161njenja po delivery_city i delivery_type\n- Metri\u010dke kolone: total_shipments, on_time_shipments, avg_delay_days\n*/", "relation_name": "\"delivery_analytics2\".\"analytics\".\"delays_by_city_type\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-07T13:17:00.308359Z", "completed_at": "2026-01-07T13:17:00.368353Z"}, {"name": "execute", "started_at": "2026-01-07T13:17:00.373376Z", "completed_at": "2026-01-07T13:17:00.634444Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3384287357330322, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_delivery_analytics.couriers_performance", "compiled": true, "compiled_code": "with shipments as (\n    select *\n    from \"delivery_analytics2\".\"analytics\".\"fct_shipments\"\n)\n\nselect\n    courier_id,\n    count(*) as total_shipments,\n    count(case when current_status = 'delivered' then 1 end) as delivered_shipments,\n    avg(delivery_duration_days) as avg_delivery_duration_days,\n    sum(case when delivery_type = 'express' then 1 else 0 end) as express_shipments_count,\n    avg(distance_km) as avg_distance_per_shipment,\n    sum(distance_km) as total_distance_per_courier,\n    (count(case when is_late_delivery = false then 1 end)::float / nullif(count(*),0))*100 as success_rate_percent,\n    count(case when current_status != 'delivered' then 1 end) as pending_shipments\nfrom shipments\ngroup by courier_id\norder by courier_id\n\n/*\nVIEW: couriers_performance\n\nSvrha:\n- Prikazuje performanse kurira\n- Metri\u010dke kolone: total_shipments, delivered_shipments, avg_delivery_duration_days,\n  express_shipments_count, avg_distance_per_shipment, total_distance_per_courier, success_rate_percent, pending_shipments\n*/", "relation_name": "\"delivery_analytics2\".\"analytics\".\"couriers_performance\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-07T13:17:00.304010Z", "completed_at": "2026-01-07T13:17:00.367641Z"}, {"name": "execute", "started_at": "2026-01-07T13:17:00.368894Z", "completed_at": "2026-01-07T13:17:00.637005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3547966480255127, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_delivery_analytics.active_delays", "compiled": true, "compiled_code": "with shipments as (\n    select *\n    from \"delivery_analytics2\".\"analytics\".\"fct_shipments\"\n    where current_status != 'delivered'\n)\n\nselect\n    shipment_id,\n    courier_id,\n    delivery_city,\n    delivery_type,\n    shipment_date,\n    expected_delivery_date,\n    current_status,\n    (current_date - expected_delivery_date) as delay_days\nfrom shipments\nwhere current_date > expected_delivery_date\norder by delay_days desc\n\n/*\nVIEW: active_delays\nSvrha:\n- Prikazuje sve aktivne po\u0161iljke koje kasne\n- Metri\u010dke kolone: delay_days\n- Koristi se za monitoring ka\u0161njenja i upozorenja\n*/", "relation_name": "\"delivery_analytics2\".\"analytics\".\"active_delays\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-07T13:17:00.651952Z", "completed_at": "2026-01-07T13:17:00.668533Z"}, {"name": "execute", "started_at": "2026-01-07T13:17:00.669373Z", "completed_at": "2026-01-07T13:17:00.828822Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.18548178672790527, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_delivery_analytics.shipment_delays", "compiled": true, "compiled_code": "with shipments as (\n    select *\n    from \"delivery_analytics2\".\"analytics\".\"fct_shipments\"\n)\n\nselect\n    shipment_id,\n    shipment_date,\n    expected_delivery_date,\n    completed_at,\n\n    -- delay_days = difference izme\u0111u expected i actual delivery\n    case\n        when completed_at is not null then \n            extract(day from (completed_at::timestamp - expected_delivery_date::timestamp))\n        else\n            extract(day from (current_date - expected_delivery_date::timestamp))\n    end as delay_days,\n\n    -- is_late_delivery\n    case\n        when completed_at is not null and completed_at > expected_delivery_date then true\n        when completed_at is null and current_date > expected_delivery_date then true\n        else false\n    end as is_late_delivery\n\nfrom shipments\n\n/*\nVIEW: fct_shipment_delays\nSvrha:\n- Ka\u0161njenje po po\u0161iljci\n- Metri\u010dke kolone: delay_days, is_late_delivery\n- Mo\u017ee se agregirati po gradu, tipu po\u0161iljke, kuriru\n*/", "relation_name": "\"delivery_analytics2\".\"analytics\".\"shipment_delays\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-07T13:17:00.664155Z", "completed_at": "2026-01-07T13:17:00.674760Z"}, {"name": "execute", "started_at": "2026-01-07T13:17:00.680067Z", "completed_at": "2026-01-07T13:17:00.852435Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.19214582443237305, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_delivery_analytics.shipments_by_time", "compiled": true, "compiled_code": "with shipments as (\n    select *\n    from \"delivery_analytics2\".\"analytics\".\"fct_shipments\"\n    where shipment_date is not null\n)\n\nselect\n    date_trunc('day', shipment_date) as day,\n    date_trunc('week', shipment_date) as week,\n    date_trunc('month', shipment_date) as month,\n    delivery_city,\n    courier_id,\n    delivery_type,\n    count(*) as total_shipments,\n    count(case when is_late_delivery = false then 1 end) as on_time_shipments,\n    avg(delivery_duration_days) as avg_delivery_days,\n    sum(price) as total_revenue,\n    sum(distance_km) as total_distance\n\nfrom shipments\ngroup by 1,2,3,4,5,6\norder by day, delivery_city, courier_id, delivery_type\n\n/*\nVIEW: shipments_by_time\n\nSvrha:\n- Analiza po\u0161iljki po danu, sedmici i mjesecu\n- Segmentacija po delivery_city, courier_id, delivery_type (standard/express)\n- Metri\u010dke kolone: total_shipments, on_time_shipments, avg_delivery_days, total_revenue, total_distance\n- Mo\u017ee se koristiti za trend analizu i dashboard vizualizacije\n*/", "relation_name": "\"delivery_analytics2\".\"analytics\".\"shipments_by_time\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-07T13:17:00.657508Z", "completed_at": "2026-01-07T13:17:00.674092Z"}, {"name": "execute", "started_at": "2026-01-07T13:17:00.675495Z", "completed_at": "2026-01-07T13:17:00.859283Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.20909571647644043, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.dbt_delivery_analytics.shipment_status", "compiled": true, "compiled_code": "with shipments as (\n    select *\n    from \"delivery_analytics2\".\"analytics\".\"fct_shipments\"\n)\n\nselect\n    current_status,\n    count(*) as total_shipments,\n    sum(case when current_status != 'delivered' then 1 else 0 end) as active_shipments\nfrom shipments\ngroup by current_status\n\n/*\nVIEW: shipment_status\nSvrha:\n- Prikazuje broj po\u0161iljki po statusu: pending, picked_up, delivered\n- Koristi se za monitoring optere\u0107enja i trenutnog statusa po\u0161iljki\n*/", "relation_name": "\"delivery_analytics2\".\"analytics\".\"shipment_status\"", "batch_results": null}], "elapsed_time": 1.0874919891357422, "args": {"vars": {}, "warn_error_options": {"error": [], "warn": [], "silence": []}, "defer": false, "partial_parse": true, "show_all_deprecations": false, "static_parser": true, "use_fast_test_edges": false, "require_nested_cumulative_type_params": false, "log_level": "info", "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "populate_cache": true, "partial_parse_file_diff": true, "require_batched_execution_for_custom_microbatch_strategy": false, "which": "run", "require_generic_test_arguments_property": true, "quiet": false, "require_resource_names_without_spaces": true, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "empty": false, "version_check": true, "strict_mode": false, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "printer_width": 80, "log_path": "C:\\Users\\Korisnik\\OneDrive\\Desktop\\dbt_delivery_analytics\\logs", "macro_debugging": false, "source_freshness_run_project_hooks": true, "require_all_warnings_handled_by_warn_error": false, "print": true, "upload_to_artifacts_ingest_api": false, "validate_macro_args": false, "select": ["views"], "log_format_file": "debug", "cache_selected_only": false, "log_format": "default", "profiles_dir": "C:\\Users\\Korisnik\\.dbt", "skip_nodes_if_on_run_start_fails": false, "exclude": [], "favor_state": false, "project_dir": "C:\\Users\\Korisnik\\OneDrive\\Desktop\\dbt_delivery_analytics", "introspect": true, "show_resource_report": false, "use_colors_file": true, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt run --select views", "log_level_file": "debug", "write_json": true, "state_modified_compare_vars": false}}